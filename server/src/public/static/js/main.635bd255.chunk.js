(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{149:function(e,t,a){e.exports=a(322)},276:function(e,t,a){},277:function(e,t,a){},278:function(e,t,a){},279:function(e,t,a){},280:function(e,t,a){},306:function(e,t){},309:function(e,t,a){},310:function(e,t,a){},311:function(e,t,a){},312:function(e,t,a){},313:function(e,t,a){},314:function(e,t,a){},318:function(e,t,a){},319:function(e,t,a){},320:function(e,t,a){},321:function(e,t,a){},322:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(27),o=a.n(c),s=a(13),l=a(11),m=a(143),i=a(326),u=a(5),d={isLoggedIn:!1,_id:null,token:null,currentChatRoom:"5f52268b6d59e14df8174254",data:{}},p=a(50),f=a(33),h=a(46),_=a.n(h),b=[],E=Object(l.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHECK_AUTH":case"LOG_IN":return Object(u.a)(Object(u.a)({},e),t.payload);case"LOG_OUT":return Object(u.a)(Object(u.a)({},e),d);case"UPDATE_USER":return Object(u.a)(Object(u.a)({},e),{},{data:Object(u.a)(Object(u.a)({},e.data),t.payload)});case"SET_CHATROOM":return Object(u.a)(Object(u.a)({},e),t.payload);default:return e}},chatrooms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CHATROOM":return Object(u.a)(Object(u.a)({},e),{},Object(f.a)({},t.payload._id,Object(u.a)({},t.payload)));case"DISPLAY_CHATROOMS":return Object(u.a)(Object(u.a)({},e),_.a.mapKeys(t.payload,"_id"));case"CLOSE_CHAT":return Object(u.a)(Object(u.a)({},e),_.a.omit(e,t.payload));case"NEW_MESSAGE":return Object(u.a)(Object(u.a)({},e),{},Object(f.a)({},t.payload.chatroomId,Object(u.a)(Object(u.a)({},e[t.payload.chatroomId]),{},{messages:[].concat(Object(p.a)(e[t.payload.chatroomId].messages),[t.payload.message])})));case"LOAD_MESSAGES":return Object(u.a)(Object(u.a)({},e),{},Object(f.a)({},t.payload.chatroomId,Object(u.a)(Object(u.a)({},e[t.payload.chatroomId]),{},{messages:Object(p.a)(t.payload.messages)})));case"LOG_OUT":return Object(u.a)(Object(u.a)({},e),b);default:return e}},form:i.a}),g=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.d,v=Object(l.e)(E,g(Object(l.a)(m.a))),y=a(10),O=a(19),N=Object(O.a)(),w=a(8),j=a.n(w),k=a(16),C=a(145),R=a.n(C);console.log("PROCESS.ENV","production");var x=R.a.create({baseURL:"https://dsc-whatschat.herokuapp.com/",headers:{"Content-Security-Policy":"default-src *"}}),I=function(){return function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=localStorage.getItem("jwt-token")){e.next=3;break}return e.abrupt("return",t({type:"CHECK_AUTH",payload:{isLoggedIn:!1,token:null}}));case 3:return e.next=5,x.get("/user-id",{headers:{Authorization:"Bearer ".concat(a)}});case 5:n=e.sent,t({type:"CHECK_AUTH",payload:{_id:n.data._id,token:a,isLoggedIn:!0,data:n.data}});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},S=a(21),A=a(7),M=a.n(A),L=a(325),T=a(324),H=Object(T.a)({form:"userForm"})((function(e){return r.a.createElement("form",{onSubmit:e.handleSubmit((function(t){var a=e.initialValues;if(!a)return e.handleForm(t);Object.keys(t).some((function(e){return""===t[e]}))&&e.reset();var n={};Object.keys(a).forEach((function(e){a[e]!==t[e]&&(n=Object(u.a)(Object(u.a)({},n),{},Object(f.a)({},e,t[e])))})),e.handleForm(n)})),className:"form-signin mt-2"},e.children)})),D=function(e){var t=function(e){var t=e.input,a=e.label,n=e.type;return r.a.createElement("div",null,r.a.createElement("label",{className:"text-white text-left my-2"},a),r.a.createElement("input",Object.assign({className:"form-control",placeholder:a},t,{type:n,required:!0})))};return r.a.createElement(H,{handleForm:function(t){e.handleForm(t)}},r.a.createElement("div",{className:"ui stacked element"},r.a.createElement(L.a,{name:"username",component:t,label:"Username",type:"text"}),r.a.createElement(L.a,{name:"password",component:t,label:"Password",type:"password"}),r.a.createElement("button",{className:"btn btn-md btn-secondary btn-block my-4 mx-auto w-25"},"Submit")),r.a.createElement("div",{className:"d-flex w-100 justify-content-center text-white"},r.a.createElement("div",{className:"col"},r.a.createElement("p",{className:"m-0 p-0"},"Sample User Credentials"),r.a.createElement("p",{className:"m-0 p-0"},"Username: sampleuser"),r.a.createElement("p",{className:"m-0 p-0"},"Password: examplepass000"))))},U=function(e){var t=function(e){var t=e.input,a=e.label,n=e.type;return r.a.createElement("div",null,r.a.createElement("label",{className:"text-white text-left my-2"},a),r.a.createElement("input",Object.assign({className:"form-control",type:n,placeholder:a},t,{required:!0})))};return r.a.createElement(H,{handleForm:function(t){e.handleForm(t)}},r.a.createElement(L.a,{name:"name",component:t,label:"Name",type:"text"}),r.a.createElement(L.a,{name:"username",component:t,label:"Username",type:"text"}),r.a.createElement(L.a,{name:"email",component:t,label:"Email",type:"email"}),r.a.createElement(L.a,{name:"password",component:t,label:"Password",type:"password"}),r.a.createElement(L.a,{name:"passwordConf",component:t,label:"Confirm Password",type:"password"}),r.a.createElement("button",{className:"btn btn-md btn-secondary btn-block mt-4 mx-auto w-50"},"Submit"))},z=(a(276),Object(s.b)(null,{signup:function(e){return function(){var t=Object(k.a)(j.a.mark((function t(a){var n,r,c;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="5f52268b6d59e14df8174254",t.next=3,x.post("/create-user",Object(u.a)({},e));case 3:if(r=t.sent,console.log(r),!r.data.error){t.next=9;break}return 11e3===(c=r.data.error).code&&alert('The username "'.concat(c.keyValue.username,'" has already been taken.')),t.abrupt("return");case 9:localStorage.setItem("jwt-token",r.data.token),a({type:"CHECK_AUTH",payload:{_id:r.data.user._id,token:r.data.token,isLoggedIn:!0,data:r.data.user}}),N.push("/chats/".concat(n));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},login:function(e){return function(){var t=Object(k.a)(j.a.mark((function t(a){var n,r,c;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("login ran"),n="5f52268b6d59e14df8174254",t.next=4,x.post("/login-user",Object(u.a)({},e));case 4:if(!(r=t.sent).data.error){t.next=9;break}return c=r.data.error,alert("".concat(c.message)),t.abrupt("return");case 9:localStorage.setItem("jwt-token",r.data.token),a({type:"LOG_IN",payload:{_id:r.data.user._id,token:r.data.token,isLoggedIn:!0,data:r.data.user}}),N.push("/chats/".concat(n));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=Object(n.useState)("signup"),a=Object(S.a)(t,2),c=a[0],o=a[1],s=function(t){e.signup(t)},l=function(t){e.login(t)},m=function(){"signup"===c&&o("login"),"login"===c&&o("signup")};return r.a.createElement("div",{className:"landing__area col"},r.a.createElement("div",{className:"landing__container container pb-3 px-3 bg-dark"},r.a.createElement("div",{className:"row mb-2"},r.a.createElement("div",{className:"col p-0"},r.a.createElement("button",{onClick:function(){return m()},className:M()({"btn btn-large text-white w-100 p-3":!0,"btn-outline-dark":"signup"===c,"btn-secondary":"login"===c}),disabled:"signup"===c},"Sign Up Here!")),r.a.createElement("div",{className:"col h-100 p-0"},r.a.createElement("button",{onClick:function(){return m()},className:M()({"btn btn-large text-white w-100 p-3":!0,"btn-outline-dark disabled":"login"===c,"btn-secondary":"signup"===c}),disabled:"login"===c},"Log In Here!"))),"signup"===c?r.a.createElement(U,{handleForm:s}):r.a.createElement(D,{handleForm:l})))}))),F=function(){return r.a.createElement(z,null)},V=a(69),B=a.n(V),P=r.a.createElement("svg",{width:"1.2em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-person",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{fillRule:"evenodd",d:"M10 5a2 2 0 1 1-4 0 2 2 0 0 1 4 0zM8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm6 5c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"})),G=r.a.createElement("svg",{width:"1.2em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-chat-right-text",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{fillRule:"evenodd",d:"M2 1h12a1 1 0 0 1 1 1v11.586l-2-2A2 2 0 0 0 11.586 11H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zm12-1a2 2 0 0 1 2 2v12.793a.5.5 0 0 1-.854.353l-2.853-2.853a1 1 0 0 0-.707-.293H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12z"}),r.a.createElement("path",{fillRule:"evenodd",d:"M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6zm0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"})),K=r.a.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-plus-square",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{fillRule:"evenodd",d:"M14 1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"}),r.a.createElement("path",{fillRule:"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})),q=r.a.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-pencil",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{fillRule:"evenodd",d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5L13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175l-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"})),Y=(a(277),function(e){return r.a.createElement("button",{className:M()("nav__icon",{"icon__button-active":e.icon===e.activeIcon,"":e.icon!==e.activeIcon}),disabled:e.icon===e.activeIcon},"profile"===e.icon?P:"chats"===e.icon?G:void 0)}),W=(a(278),function(e){var t=e.type,a=e.messageKey,n=e.timestamp,c=e.author,o=e.message;return r.a.createElement("li",{key:a,className:"message message__".concat(t)},r.a.createElement("div",{className:"message__container message__container-".concat(t)},r.a.createElement("div",{className:"message__content"},r.a.createElement("div",{className:"message__row message__row-body"},r.a.createElement("p",{className:"message__text message__text-author"},c),r.a.createElement("p",{className:"message__text message__text-message"},o)),r.a.createElement("div",{className:"message__row message__row-footer"},r.a.createElement("div",{className:"message__timestamp"},n)))))}),J=(a(279),Object(s.b)((function(e){return{auth:e.auth}}))((function(e){var t=e.messages,a=e.auth,c=Object(n.useRef)(null);Object(n.useEffect)((function(){return function(e){var t=e.current.lastElementChild;if(t){var a=getComputedStyle(t.lastElementChild),n=parseInt(a.marginBottom),r=e.current.offsetHeight+n,c=e.current.offsetHeight;e.current.scrollHeight-r<=e.current.scrollTop+c&&(e.current.scrollTop=e.current.scrollHeight)}}(c)}),[t.length]);return r.a.createElement("div",{className:"chatroom__content"},r.a.createElement("ul",{className:"message__display message__display-scroll ",ref:c},t?Object.keys(t).map((function(e){var n,c=(n=t[e].createdAt,B()(n).format("h:mm A"));return"systemManager"===t[e].author?r.a.createElement(W,{key:e,type:"system",timestamp:c,author:t[e].author,message:t[e].message}):r.a.createElement(W,{key:e,type:t[e].userId!==a._id?"rec":"sent",timestamp:c,author:t[e].author,message:t[e].message})})):r.a.createElement("div",{className:"text-white"},"Send a message!!")))}))),X=(a(280),function(e){var t=e.message,a=e.onSubmit,n=e.onChange;return r.a.createElement("div",{className:"chatroom__message"},r.a.createElement("form",{className:"new-message__form",onSubmit:a},r.a.createElement("div",{className:"message-form__row"},r.a.createElement("div",{className:"message-form__col message-form__col-input"},r.a.createElement("input",{className:"message-form__input form-control",placeholder:"Message...",type:"text",value:t,onChange:n})),r.a.createElement("div",{className:"message-form__col message-form__col-cta"},r.a.createElement("button",{className:"message-form__cta button"},"Send")))))}),Q=a(147),Z=a.n(Q)()(),$=function(){return function(){var e=Object(k.a)(j.a.mark((function e(t,a){var n,r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.get("/MessagesDisplay");case 3:n=e.sent,r=n.data,c=r.chats.map((function(e){var t=0!==a().chatrooms.length?a().chatrooms[e._id].messages:[];return Object(u.a)(Object(u.a)({},e),{},{messages:Object(p.a)(t)})})),console.log("chatrooms",c),t({type:"DISPLAY_CHATROOMS",payload:Object(u.a)({},c)}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a){return e.apply(this,arguments)}}()};Z.on("return-message",(function(e){var t;v.dispatch({type:"NEW_MESSAGE",payload:{chatroomId:(t=e).chatroomId,message:t}})}));a(309);var ee=function(e){var t=e.chatroomName;return r.a.createElement("div",{className:"chatroom__heading"},r.a.createElement("h2",{className:"chatroom__title"},t))},te=(a(310),Object(s.b)((function(e){return{auth:e.auth,defaultChatRoom:e.chatrooms.defaultChatRoom,chatrooms:e.chatrooms}}),{sendMessage:function(e){var t=e.chatroomId,a=e.message,n=e.userId,r=e.author;return function(){var e=Object(k.a)(j.a.mark((function e(c){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("send message ran"),console.log(t),Z.emit("message",{chatroomId:t,message:a,userId:n,author:r});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},checkAuth:I,joinChatRoom:function(e,t){return function(){var a=Object(k.a)(j.a.mark((function a(n){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:Z.emit("join",{room:e,userName:t},(function(e){console.info("connected to ".concat(e))}));case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},leaveChatRoom:function(e,t){return function(){var a=Object(k.a)(j.a.mark((function a(n){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:Z.emit("leave",{room:e,userName:t},(function(e){console.log("leaving ".concat(e))}));case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},fetchMessages:function(e){return function(){var t=Object(k.a)(j.a.mark((function t(a){var n,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.get("/messages?chatroomId=".concat(e));case 2:n=t.sent,r=n.data,a({type:"LOAD_MESSAGES",payload:{chatroomId:e,messages:r.messages}});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},displayChatRooms:$})((function(e){var t=e.chatrooms,a=e.auth,c=e.sendMessage,o=e.joinChatRoom,s=e.leaveChatRoom,l=e.fetchMessages,m=Object(n.useState)(""),i=Object(S.a)(m,2),u=i[0],d=i[1],p=Object(n.useState)(a.currentChatRoom),f=Object(S.a)(p,2),h=f[0],_=f[1];Object(n.useEffect)((function(){console.log(a.data.name),s(h,a.data.name),o(a.currentChatRoom,a.data.name),_(a.currentChatRoom)}),[a.data.name,h,a.currentChatRoom,o]),Object(n.useEffect)((function(){t[h].messages.length<1&&l(h)}),[h]);return r.a.createElement("div",{className:"chatroom__display"},r.a.createElement("div",{className:"chatroom__container"},r.a.createElement(ee,{chatroomName:t[h].name}),r.a.createElement(J,{messages:t[h].messages}),r.a.createElement(X,{message:u,onSubmit:function(e){e.preventDefault(),c({message:u,chatroomId:a.currentChatRoom,userId:a._id,author:a.data.username}),d("")},onChange:function(e){d(e.target.value)}})))}))),ae=function(){return r.a.createElement(te,null)},ne=a(51),re=a(18),ce=(a(311),function(e){var t=e.auth,a=e.updateUser,c=e.logout,o=e.setModalDisplay,s=Object(n.useState)(""),l=Object(S.a)(s,2),m=l[0],i=l[1],u=function(e){var t=e.input,a=e.label,n=e.meta,c="field ".concat(n.error&&n.touched?"error":"");return r.a.createElement("div",{className:"row__content ".concat(c)},r.a.createElement("div",{className:"content__col content__col-label"},r.a.createElement("label",{className:"profile__label"},a)),r.a.createElement("div",{className:"content__col content__col-input"},m===a?r.a.createElement("input",Object.assign({className:"profile__input form-control"},t)):r.a.createElement("input",Object.assign({className:"profile__input-placeholder form-control-plaintext"},t))),r.a.createElement("div",{className:"content__col content__col-cta"},r.a.createElement("div",{onClick:function(){return i(a)},className:"profile__cta-edit"},q)),function(e){var t=e.error;if(e.touched&&t)return r.a.createElement("div",{className:"ui error message"},r.a.createElement("div",{className:"header"},t))}(n))};return r.a.createElement(ne.a,{className:"profile__card"},r.a.createElement(ne.a.Img,{className:"profile__avatar",variant:"top",src:"data:image/png;base64,".concat(t.data.avatar)}),r.a.createElement(ne.a.Body,{className:"profile__body"},r.a.createElement(H,{handleForm:function(e){a(e),i("")},initialValues:_.a.pick(t.data,"name","username","email","password")},r.a.createElement(re.a,{className:"profile__content",variant:"flush"},r.a.createElement(re.a.Item,{className:"profile__row"},r.a.createElement(L.a,{name:"name",component:u,label:"Name:"})),r.a.createElement(re.a.Item,{className:"profile__row"},r.a.createElement(L.a,{name:"username",component:u,label:"Username:"})),r.a.createElement(re.a.Item,{className:"profile__row"},r.a.createElement(L.a,{name:"email",component:u,label:"Email:"})),r.a.createElement(re.a.Item,{className:"profile__row"},r.a.createElement(L.a,{name:"password",component:u,label:"Password:"})),r.a.createElement("input",{type:"submit",className:"profile__submit",tabIndex:"-1"})))),r.a.createElement(ne.a.Footer,{className:"profile__footer"},r.a.createElement(re.a,{className:"profile__row",variant:"flush"},r.a.createElement(re.a.Item,{className:"profile__row"},r.a.createElement("div",{className:"row justify-content-around"},r.a.createElement("div",{className:"col text-center"},"User Since: ",B()(t.data.createdAt).format("MMM 'YY")))),r.a.createElement(re.a.Item,{className:"profile__row"},r.a.createElement("button",{onClick:function(){return c()},className:"profile__cta profile__cta-logout button"},"Log Out")),r.a.createElement(re.a.Item,{className:"profile__row"},r.a.createElement("button",{onClick:function(){return o(!0)},className:"profile__cta profile__cta-delete button",disabled:"5f637fdd0a41ae691c828e50"===t.data._id},"Delete Account")))))}),oe=a(148),se=a(73),le=a(71),me=a(72),ie=a(74),ue=function(e){var t=e.modalConfig,a=e.setModalDisplay,n=e.modalDisplay,c=e.handleDelete;return n?r.a.createElement(oe.a,{show:n,onHide:function(){return a(!1)}},r.a.createElement(ie.a,{closeButton:!0},r.a.createElement(me.a,null,t.title)),r.a.createElement(le.a,null,r.a.createElement("p",null,t.message)),r.a.createElement(se.a,null,r.a.createElement("button",{onClick:function(){return a(!1)},type:"button",className:"btn btn-secondary"},"Cancel"),r.a.createElement("button",{onClick:function(){return a(!1),void c()},className:"btn btn-".concat(t.btnStyle)},t.btnText))):r.a.createElement(r.a.Fragment,null)},de=(a(312),Object(s.b)((function(e){return{auth:e.auth}}),{logout:function(){return function(){var e=Object(k.a)(j.a.mark((function e(t,a){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a().auth.token,e.next=3,x.post("/logout",{},{headers:{Authorization:"Bearer ".concat(n)}});case 3:return e.next=5,localStorage.removeItem("jwt-token");case 5:t({type:"LOG_OUT"}),N.push("/");case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},updateUser:function(e){return function(){var t=Object(k.a)(j.a.mark((function t(a,n){var r,c,o;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n().auth.token,t.next=3,x.patch("./user-update",Object(u.a)({},e),{headers:{Authorization:"Bearer ".concat(r)}});case 3:if(!(c=t.sent).data.error){t.next=8;break}return 11e3===(o=c.data.error).code&&alert('The username "'.concat(o.keyValue.username,'" has already been taken.')),t.abrupt("return");case 8:a({type:"UPDATE_USER",payload:c.data.user});case 9:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()},deleteUser:function(){return function(){var e=Object(k.a)(j.a.mark((function e(t,a){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a().auth.token,e.next=3,x.post("/user-delete",{},{headers:{Authorization:"Bearer ".concat(n)}});case 3:if(!e.sent.data.userDeleted){e.next=10;break}return e.next=7,localStorage.removeItem("jwt-token");case 7:return e.next=9,t({type:"LOG_OUT"});case 9:N.push("/");case 10:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}})((function(e){var t=e.auth,a=e.logout,c=e.updateUser,o=e.deleteUser,s=Object(n.useState)(!1),l=Object(S.a)(s,2),m=l[0],i=l[1],u=t.isLoggedIn?r.a.createElement(ce,{auth:t,updateUser:c,logout:a,setModalDisplay:i}):r.a.createElement("div",{className:"text-white"},"Log in to see your profile");return r.a.createElement("div",{className:"sidebar__profile"},u,r.a.createElement(ue,{modalConfig:{title:"Delete Account",message:"Are you sure you want to delete your account?",btnText:"Delete",btnStyle:"danger"},setModalDisplay:i,modalDisplay:m,handleDelete:function(){o()}}))}))),pe=(a(313),function(e){var t=e.newRoomName.length<5&&0!==e.newRoomName.length?"is-invalid":null;return r.a.createElement("form",{className:"sidebar__form",onSubmit:function(t){e.handleForm(t)}},r.a.createElement("div",{className:"sidebar__form_col sidebar__form_col-start"},r.a.createElement("input",{onChange:function(t){e.onChange(t)},className:"sidebar__form_input form-control ".concat(t),type:"text",placeholder:"Start new chat",name:"chatForm",required:!0})),r.a.createElement("div",{className:"sidebar__form_col sidebar__form_col-end"},r.a.createElement("button",{type:"submit",className:"sidebar__cta-new"},K)))}),fe=a(96),he=(a(314),function(e){var t=e.chatroomId,a=e.chatroomName,n=e.setChatRoom,c=e.handleClose;return console.log(t,a),r.a.createElement(re.a.Item,{className:"list__item"},r.a.createElement("div",{className:"item__col"},r.a.createElement(fe.a,{onClick:function(){return n(t)},className:"item__link",to:{pathname:"/chats/".concat(t)}},r.a.createElement("div",{className:"link__icon"},P),r.a.createElement("div",{className:"link__name"},r.a.createElement("div",{className:"link__text"},a)))),r.a.createElement("div",{className:"item__col item__col-cta"},r.a.createElement("button",{onClick:function(){return c(t)},className:"item__cta"},"\ud83d\uddd9")))}),_e=(a(318),Object(s.b)((function(e){return{auth:e.auth,chatrooms:e.chatrooms}}),{createChatRoom:function(e,t){return function(){var a=Object(k.a)(j.a.mark((function a(n){var r,c;return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,x.post("/create-chatroom",{name:e,createdBy:t});case 3:r=a.sent,c=r.data,n({type:"ADD_CHATROOM",payload:Object(u.a)(Object(u.a)({},c.chat),{},{messages:[]})}),N.push("/chats/".concat(c.chat._id)),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),n({type:"ERROR",error:"Invalid Name"});case 12:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(e){return a.apply(this,arguments)}}()},displayChatRooms:$,closeChat:function(e){return function(){var t=Object(k.a)(j.a.mark((function t(a){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Z.emit("leave",{room:e}),a({type:"CLOSE_CHAT",payload:e});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},setChatRoom:function(e){return function(){var t=Object(k.a)(j.a.mark((function t(a){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"SET_CHATROOM",payload:{currentChatRoom:e}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.auth,a=e.chatrooms,c=e.displayChatRooms,o=e.createChatRoom,s=e.closeChat,l=e.setChatRoom,m=Object(n.useState)(""),i=Object(S.a)(m,2),u=i[0],d=i[1],p=Object.keys(a).length;Object(n.useEffect)((function(){t.token&&c()}),[p,t.token,c]);var f=function(e){d(e.target.value)},h=function(e){s(e)},_=function(e){e.preventDefault(),u.length>=5&&(o(u,t._id),d(""))},b=t.isLoggedIn?r.a.createElement(re.a,{className:"chatroom__list"},r.a.createElement(re.a.Item,{className:"list__item list__item-new"},r.a.createElement(pe,{handleForm:_,onChange:f,newRoomName:u})),function(){if(a!=={})return Object.keys(a).map((function(e){return r.a.createElement(he,{key:a[e]._id,chatroomId:a[e]._id,chatroomName:a[e].name,setChatRoom:l,handleClose:h})}))}()):r.a.createElement("div",{className:"text-white"},"Log in to see chatrooms");return r.a.createElement("div",{className:"chatroom__list"},b)}))),be=(a(319),function(e){var t=e.auth,a=Object(n.useState)("chats"),c=Object(S.a)(a,2),o=c[0],s=c[1];Object(n.useEffect)((function(){return function(){s("chats")}}),[t]);var l="chats"===o?r.a.createElement(_e,null):r.a.createElement(de,null);return r.a.createElement("div",{className:"sidebar"},r.a.createElement("nav",{className:"sidebar__nav"},r.a.createElement("ul",{className:"nav__list list-unstyled components"},function(e){var t=e.icons,a=e.setCurrentIcon,n=e.activeIcon;return t.map((function(e){return r.a.createElement("li",{id:"".concat(e,"-cta"),key:e,className:"nav__item ".concat(n===e?"nav__item-active":""," nav-item"),onClick:function(e){return a(e)}},r.a.createElement(Y,{icon:e,activeIcon:n}))}))}({icons:["profile","chats"],setCurrentIcon:function(e){return"profile-cta"===e.currentTarget.id?s("profile"):s("chats")},activeIcon:o}))),r.a.createElement("div",{className:"sidebar__content"},r.a.createElement("div",{className:"sidebar__row py-4"},r.a.createElement("h2",{className:"sidebar__title"},"WhatsChat")),r.a.createElement("div",{className:"sidebar__row"},l)))}),Ee=(a(320),a(321),Object(s.b)((function(e){return{auth:e.auth}}),{checkAuth:I,displayChatRooms:$})((function(e){var t=e.auth,a=e.checkAuth,c=e.displayChatRooms;return Object(n.useEffect)((function(){t.token||(a(),c())}),[t.token,a,c]),r.a.createElement("div",{className:"display wrapper"},r.a.createElement(y.c,{history:N},r.a.createElement(r.a.Fragment,null,r.a.createElement(be,{auth:t.isLoggedIn}),r.a.createElement(y.d,null,r.a.createElement(y.b,{path:"/",exact:!0},t.isLoggedIn?r.a.createElement(y.a,{to:"/chats/".concat(t.currentChatRoom)}):r.a.createElement(F,null)),r.a.createElement(y.b,{path:"/chats"},t.isLoggedIn?r.a.createElement(ae,null):r.a.createElement(y.a,{to:"/"}))))))})));o.a.render(r.a.createElement(s.a,{store:v},r.a.createElement(Ee,null)),document.querySelector("#root"))}},[[149,1,2]]]);
//# sourceMappingURL=main.635bd255.chunk.js.map